# 802.1.x-Security-Vulnerabilities
The IEEE 802.1X is a standard for port-based network access control (PNAC) commonly used in enterprise Wi-Fi and wired Ethernet networks to provide strong authentication, authorization, and accounting (AAA). Despite its security benefits, 802.1X has several vulnerabilities and attack vectors


| Attack Vector               | Test Case                  | Test Steps                                                                                   | Description                                                                                     | Tools                                                                                                                                  |
|-----------------------------|----------------------------|---------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------|
| 1. MitM - Rogue APs         | Set up a rogue AP          | 1. Configure a laptop as a rogue AP with hostapd                                             | Rogue APs are unauthorized access points set up to mimic legitimate APs to intercept network traffic. | Software: hostapd, Wireshark<br>Hardware: Laptop with Wi-Fi card (e.g., Alfa AWUS036ACH)                                              |
|                             |                            | 2. Clone SSID and BSSID of a legitimate AP                                                   |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Try to intercept 802.1X handshakes                                                        |                                                                                                  |                                                                                                                                        |
| 1. MitM - Evil Twin         | Deploy evil twin AP        | 1. Use EAPHammer to set up an evil twin                                                      | Evil twin APs are malicious APs that trick users into connecting by presenting a stronger signal. | Software: EAPHammer, dsniff<br>Hardware: High-gain antenna (e.g., Yagi directional)                                                  |
|                             |                            | 2. Offer stronger signal than legitimate AP                                                  |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Capture user credentials                                                                  |                                                                                                  |                                                                                                                                        |
| 2. EAP-MD5 Weakness         | Test EAP-MD5 strength      | 1. Set up a network using EAP-MD5                                                            | EAP-MD5 is susceptible to offline dictionary attacks due to its weak cryptographic properties. | Software: FreeRADIUS, Wireshark, John the Ripper<br>Hardware: Standard Wi-Fi adapter                                                    |
|                             |                            | 2. Capture EAP-MD5 challenge-response                                                        |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Use John the Ripper for offline cracking                                                  |                                                                                                  |                                                                                                                                        |
| 2. LEAP Vulnerability       | Attack Cisco LEAP          | 1. Configure a client to use LEAP                                                            | Cisco LEAP has known vulnerabilities, making it easy to crack using dictionary attacks.       | Software: Cisco AnyConnect, Wireshark, asleap<br>Hardware: Cisco AP (e.g., Aironet series)                                           |
|                             |                            | 2. Capture LEAP handshake with Wireshark                                                     |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Use asleap tool for dictionary attack                                                     |                                                                                                  |                                                                                                                                        |
| 2. EAP-TLS MitM             | Exploit weak TLS           | 1. Set up EAP-TLS without cert validation                                                    | Weak EAP-TLS configurations can be exploited if certificate validation is not enforced.      | Software: OpenSSL, sslsplit, mitmproxy<br>Hardware: Dual-NIC laptop                                                                   |
|                             |                            | 2. Use sslsplit for MitM interception                                                        |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Verify decrypted traffic access                                                           |                                                                                                  |                                                                                                                                        |
| 3. EAP Identity Leak        | Sniff EAP Identity         | 1. Start 802.1X authentication                                                               | EAP identity frames can reveal usernames in plaintext, potentially compromising user privacy. | Software: Wireshark, tshark<br>Hardware: Any Wi-Fi adapter in monitor mode                                                             |
|                             |                            | 2. Capture EAP-Identity-Response                                                             |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Check if username is in clear text                                                        |                                                                                                  |                                                                                                                                        |
| 3. IMSI Catching            | Capture IMSI in EAP-SIM    | 1. Configure EAP-SIM on network                                                              | IMSI catching involves capturing International Mobile Subscriber Identity during EAP-SIM authentication. | Software: YateBTS, OpenBTS<br>Hardware: USRP B210, SIM card reader                                                                    |
|                             |                            | 2. Use a fake base station (like YateBTS)                                                    |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Trigger EAP-SIM and capture IMSI                                                          |                                                                                                  |                                                                                                                                        |
| 4. RADIUS Impersonation     | Fake RADIUS server         | 1. Set up FreeRADIUS with stolen certs                                                       | A fake RADIUS server can be set up to impersonate a legitimate one and intercept authentication data. | Software: FreeRADIUS, OpenSSL<br>Hardware: Server machine (e.g., Raspberry Pi)                                                        |
|                             |                            | 2. Configure AP to use this server                                                           |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Verify client connects to fake server                                                     |                                                                                                  |                                                                                                                                        |
| 4. RADIUS DoS               | Flood RADIUS server        | 1. Use RadSpoof or Scapy                                                                     | Denial of Service (DoS) attacks on RADIUS servers can disrupt authentication services by overwhelming them with fake requests. | Software: RadSpoof, Scapy, htop<br>Hardware: High-performance NIC (e.g., Intel X520)                                                    |
|                             |                            | 2. Generate thousands of fake RADIUS requests                                                |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Monitor server for slowdown or crash                                                      |                                                                                                  |                                                                                                                                        |
| 5. Weak Supplicant          | Misconfigure client        | 1. Set up client with EAP-MD5                                                                | Misconfigured supplicants can easily be exploited, especially if they don't validate server certificates. | Software: wpa_supplicant (modified)<br>Hardware: Any Wi-Fi client device                                                               |
|                             |                            | 2. Disable server cert validation                                                            |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Test if it connects to rogue AP                                                           |                                                                                                  |                                                                                                                                        |
| 5. Credential Theft         | Plant malware              | 1. Create a trojan with PowerShell                                                           | Malware can be used to steal saved Wi-Fi credentials from a client's device.                   | Software: PowerShell Empire, Metasploit<br>Hardware: Target machine (any OS)                                                           |
|                             |                            | 2. Target `wpa_supplicant.conf` or registry                                                  |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Exfiltrate saved Wi-Fi credentials                                                        |                                                                                                  |                                                                                                                                        |
| 6. Weak Key Generation      | Test PRF strength          | 1. Use EAP method with weak PRF (e.g., MD5 in LEAP)                                          | Weak Pseudo-Random Function (PRF) implementations can lead to weak cryptographic keys.       | Software: Wireshark, cryptool<br>Hardware: GPU for cracking (e.g., NVIDIA RTX 3080)                                                   |
|                             |                            | 2. Capture 4-way handshake                                                                   |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Analyze key strength with cryptool                                                        |                                                                                                  |                                                                                                                                        |
| 6. KRACK Attack             | Reinstall WPA2 keys        | 1. Set up WPA 2-Enterprise network                                                            | The KRACK attack targets WPA2 protocol weaknesses to reinstall previously used keys, enabling decryption of traffic. | Software: krackattacks-poc-zerokey, hostapd<br>Hardware: Two Wi-Fi adapters                                                               |
|                             |                            | 2. Use krackattacks-poc-zerokey tool                                                         |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Force key reinstallation and decrypt                                                      |                                                                                                  |                                                                                                                                        |
| 7. EAPoL Start Flood        | DoS authenticator          | 1. Use Scapy to craft EAPoL-Start frames                                                     | Flooding an AP with EAPoL-Start frames can prevent legitimate users from authenticating.   | Software: Scapy, Python<br>Hardware: Wi-Fi adapter with packet injection                                                                |
|                             |                            | 2. Flood AP with these frames                                                                |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Check if legitimate users can't connect                                                   |                                                                                                  |                                                                                                                                        |
| 7. MAC Spoofing             | Bypass MAC filtering       | 1. Sniff a valid client's MAC                                                                | MAC spoofing involves changing the MAC address of an attacker’s device to bypass MAC filtering. | Software: Kismet, macchanger<br>Hardware: Any Wi-Fi adapter                                                                              |
|                             |                            | 2. Use macchanger to spoof this MAC                                                          |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Attempt to start 802.1X auth                                                              |                                                                                                  |                                                                                                                                        |
| 8. Session Hijacking        | Takeover session           | 1. Use Wireshark to get session identifiers                                                  | Session hijacking allows attackers to take over an active session by mimicking the user's session identifiers. | Software: Wireshark, Scapy, Bettercap<br>Hardware: Same NIC brand as target                                                             |
|                             |                            | 2. Craft packets with Scapy to mimic user                                                    |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Try to continue the session                                                               |                                                                                                  |                                                                                                                                        |
| 8. VLAN Hopping             | Jump VLANs                 | 1. Auth to a low-privilege VLAN                                                              | VLAN hopping attacks exploit vulnerabilities to access different VLANs beyond the one assigned. | Software: yersinia, VLANs.py<br>Hardware: Managed switch (e.g., Cisco 3750)                                                            |
|                             |                            | 2. Use yersinia for double tagging                                                           |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Attempt to access restricted VLAN                                                         |                                                                                                  |                                                                                                                                        |
| 9. Port Stealing            | Hijack Ethernet port       | 1. Locate an authenticated device                                                            | Port stealing involves physically taking over a network port by disconnecting a legitimate device and connecting an attacker's device. | Software: OpenWrt, FreeRADIUS<br>Hardware: TP-Link WR1043ND (OpenWrt compatible)                                                        |
|                             |                            | 2. Physically unplug its Ethernet                                                            |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Plug in attacker's device                                                                 |                                                                                                  |                                                                                                                                        |
| 9. MAC Flooding             | Turn switch to hub         | 1. Use macof to send many MAC addresses                                                      | MAC flooding attacks overload a switch's CAM table, forcing it to act like a hub and broadcast all traffic. | Software: macof (dsniff suite), Wireshark<br>Hardware: High-speed NIC (10 Gbps+)                                                       |
|                             |                            | 2. Fill switch's CAM table                                                                   |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Use Wireshark to see all traffic                                                          |                                                                                                  |                                                                                                                                        |
| 10. Offline Dictionary      | Attack EAP-TTLS            | 1. Set up EAP-TTLS with weak password                                                        | Offline dictionary attacks involve capturing authentication handshakes and cracking them offline using password dictionaries. | Software: hcxdumptool, hashcat<br>Hardware: Wi-Fi adapter (Alfa AWUS036ACH), GPU                                                      |
|                             |                            | 2. Use hcxdumptool to capture handshake                                                      |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Run hashcat for offline cracking                                                          |                                                                                                  |                                                                                                                                        |
| 10. Downgrade Attack        | Force weaker EAP           | 1. Use hostapd-wpe as rogue AP                                                               | Downgrade attacks force clients to use a less secure EAP method by only offering the weaker option. | Software: hostapd-wpe, EAPHammer<br>Hardware: Dual-band Wi-Fi adapter                                                                  |
|                             |                            | 2. Only offer EAP-MD5 to clients                                                             |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. See if clients downgrade                                                                  |                                                                                                  |                                                                                                                                        |
| 11. Buffer Overflow         | Exploit EAP code           | 1. Find open-source EAP supplicant                                                           | Buffer overflow vulnerabilities in EAP implementations can be exploited to execute arbitrary code. | Software: AFL, Boofuzz, GDB<br>Hardware: High-CPU machine (many cores)                                                                  |
|                             |                            | 2. Fuzz it with AFL or Boofuzz                                                               |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Look for crashes indicating overflow                                                      |                                                                                                  |                                                                                                                                        |
| 11. State Machine Bug       | Confuse 802.1X states      | 1. Use Scapy to craft invalid state transitions                                              | State machine bugs exploit weaknesses in the state handling logic of 802.1X implementations. | Software: Scapy, Sulley, Wireshark<br>Hardware: Wi-Fi adapter with good driver                                                           |
|                             |                            | 2. Send logoff during negotiation                                                            |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Check for erratic AP behavior                                                             |                                                                                                  |                                                                                                                                        |
| 12. Phishing                | Fake captive portal        | 1. Set up a fake AP without 802.1X                                                           | Phishing attacks involve setting up fake APs to trick users into entering their credentials on a fake login page. | Software: hostapd, Apache, BeEF<br>Hardware: Raspberry Pi, USB Wi-Fi                                                                    |
|                             |                            | 2. Redirect to phishing page                                                                 |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Collect entered credentials                                                               |                                                                                                  |                                                                                                                                        |
| 12. Shoulder Surfing        | Observe password entry     | 1. Position near victim in public space                                                      | Shoulder surfing involves physically observing a user entering their credentials, typically in a public place. | Software: None<br>Hardware: None (just good eyesight)                                                                                   |
|                             |                            | 2. Watch as they type 802.1X password                                                        |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Note down the password                                                                    |                                                                                                  |                                                                                                                                        |
| 13. EAPoL-Logoff Flood      | Mass deauthentication      | 1. Use MDK3 or custom script                                                                 | Flooding a network with EAPoL-Logoff frames can force all clients to disconnect, causing a denial of service. | Software: MDK3, Python script<br>Hardware: Wi-Fi adapter (Alfa AWUS036NEH)                                                            |
|                             |                            | 2. Send EAPoL-Logoff to all clients                                                          |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Verify they're disconnected                                                               |                                                                                                  |                                                                                                                                        |
| 13. Resource Exhaustion     | Overwhelm resources        | 1. Use Metasploit's auxiliary/dos/radius                                                     | Resource exhaustion attacks overload network devices or servers, rendering them unusable.       | Software: Metasploit, Nmap, htop<br>Hardware: Server for DoS (high bandwidth)                                                         |
|                             |                            | 2. Target RADIUS server or switch                                                            |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Monitor CPU and memory usage                                                              |                                                                                                  |                                                                                                                                        |
| 14. Advanced Evil Twin      | 802.1X-capable twin        | 1. Use hostapd-wpe for full EAP support                                                      | Advanced evil twin attacks use sophisticated tools to mimic legitimate APs and capture full session data. | Software: hostapd-wpe, EAPHammer<br>Hardware: Multiple Wi-Fi radios (AWUS036ACS)                                                       |
|                             |                            | 2. Clone all settings including CA certs                                                     |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Try to intercept full session                                                             |                                                                                                  |                                                                                                                                        |
| 14. Rogue Authenticators    | Fake network devices       | 1. Configure a device as 802.1X authenticator                                                | Rogue authenticators are fake network devices that trick clients into authenticating against them. | Software: OpenWrt, FreeRADIUS<br>Hardware: TP-Link WR1043ND (OpenWrt compatible)                                                       |
|                             |                            | 2. Make it look like a legitimate switch                                                     |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. See if clients attempt to auth                                                            |                                                                                                  |                                                                                                                                        |
| 15. Timing Attack           | Time password checks       | 1. Modify wpa_supplicant for timing info                                                     | Timing attacks exploit the time differences in processing different inputs to infer sensitive information. | Software: Modified wpa_supplicant, Python<br>Hardware: High-precision timer (e.g., Intel TSC)                                          |
|                             |                            | 2. Send many EAP-Response/Identity                                                           |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Analyze response times for leaks                                                          |                                                                                                  |                                                                                                                                        |
| 15. Power Analysis          | Attack EAP-TLS smartcard   | 1. Set up EAP-TLS with smartcard                                                             | Power analysis attacks involve measuring power consumption of a device to extract cryptographic keys. | Software: ChipWhisperer, OpenSSL<br>Hardware: ChipWhisperer-Lite, Smart Card Reader                                                    |
|                             |                            | 2. Use ChipWhisperer for power traces                                                        |                                                                                                  |                                                                                                                                        |
|                             |                            | 3. Try to extract private key                                                                |                                                                                                  |                                                                                                                                        |


--

### Attack Surface for Enterprise 802.1X

| Attack Surface                       | Attack Vector                 | Description                                                                                                                     | Techniques Used                                                                                                                | How to Perform                                                                                                                  | How to Detect If Successful                                     |
|--------------------------------------|-------------------------------|---------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------|
| EAPOL (Extensible Authentication Protocol over LAN) | EAPOL Start Injection         | Injecting spoofed EAPOL-Start frames to initiate the authentication process and possibly disrupt normal operations              | `mdk4 mon0 e -t <MAC_AP>`                                                                                                     | Use `mdk4` to inject EAPOL-Start frames.                                                                                       | Monitor for unusual EAPOL-Start frame patterns.                  |
| EAPOL (Extensible Authentication Protocol over LAN) | EAPOL Logoff Injection        | Injecting EAPOL-Logoff frames to disconnect clients from the network                                                            | `mdk4 mon0 e -t <MAC_AP> -l`                                                                                                  | Use `mdk4` to inject EAPOL-Logoff frames.                                                                                        | Monitor for unexpected EAPOL-Logoff frame patterns.              |
| EAP (Extensible Authentication Protocol)           | EAP Spoofing                  | Spoofing EAP messages to trick the network into granting unauthorized access or disrupting authentication                        | Tools like `ettercap`, `freeradius-wpe`                                                                                       | Use tools to capture and replay EAP messages or simulate a rogue RADIUS server.                                               | Monitor for abnormal EAP message sequences.                      |
| PEAP (Protected Extensible Authentication Protocol) | PEAP Downgrade Attack         | Downgrading the PEAP version or cipher suite to exploit vulnerabilities in older protocols or weaker encryption                  | `hostapd-wpe`, `freeradius-wpe`                                                                                               | Use `hostapd-wpe` or `freeradius-wpe` to set up a rogue AP and force clients to connect using weaker security settings.       | Monitor for downgrade attempts and use strong protocol settings. |
| RADIUS (Remote Authentication Dial-In User Service) | RADIUS Replay Attack          | Capturing and replaying RADIUS messages to gain unauthorized access or disrupt the authentication process                        | Tools like `ettercap`, packet captures                                                                                       | Capture RADIUS traffic and replay it using network tools.                                                                     | Monitor for duplicate or unexpected RADIUS messages.             |
| Certificate-based Authentication    | Certificate Forgery           | Forging or stealing certificates to impersonate legitimate devices or users                                                      | Tools like `mitmproxy`, `openssl`                                                                                            | Use tools to generate fake certificates or intercept and modify certificates during transmission.                             | Implement strict certificate validation and logging.              |
| MS-CHAPv2                            | MS-CHAPv2 Cracking            | Exploiting weaknesses in MS-CHAPv2 to crack the challenge-response and gain credentials                                          | Tools like `asleap`, `hashcat`                                                                                                | Capture the MS-CHAPv2 challenge-response handshake and crack it offline using tools like `asleap` or `hashcat`.               | Monitor for unauthorized capture and cracking attempts.           |
| WPA2-Enterprise                     | Rogue AP                      | Setting up a rogue AP to capture authentication credentials or redirect clients                                                  | `hostapd`, `hostapd-wpe`                                                                                                      | Use `hostapd` or `hostapd-wpe` to set up a rogue AP that mimics a legitimate one.                                             | Monitor for unauthorized APs and unusual network behavior.       |
| Wireless LAN (WLAN)                 | Deauthentication Attack       | Sending deauthentication frames to disconnect clients from the AP                                                                | `aireplay-ng --deauth`, `mdk4`                                                                                                | Use `aireplay-ng` or `mdk4` to send deauthentication frames to target clients.                                                | Monitor for excessive deauthentication frames and client disconnections. |
| Wireless LAN (WLAN)                 | Beacon Flooding               | Flooding the network with fake beacon frames to confuse clients and network monitoring tools                                     | `mdk4 mon0 b -a -w nta -m`                                                                                                    | Use `mdk4` to send numerous fake beacon frames.                                                                               | Monitor for excessive beacon frames and unauthorized APs.        |

### Notes
- **Tools and Techniques:** The listed tools and techniques are used by security professionals and attackers alike to test and exploit weaknesses in enterprise 802.1X networks.
- **Monitoring and Detection:** Continuous monitoring and intrusion detection systems are crucial in identifying and mitigating these attacks.
- **Strong Security Practices:** Implementing strong security practices, such as using strong encryption protocols, regular security audits, and robust certificate management, can help defend against these attacks.
